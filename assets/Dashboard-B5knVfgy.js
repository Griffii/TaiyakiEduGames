import{d as Q,r as g,c as A,o as X,a as u,b as e,t as y,e as R,s as q,f as c,_ as Y,g as pe,n as L,F as Z,h as J,i as de,w as O,j as ce,k as Ae,u as xe,l as te,m as ue,p as Ie,q as Se,v as B,x as Ee,C as We,y as j}from"./index-CYZ2aWoM.js";const Me={class:"dw-root","aria-label":"Daily Word"},ze={class:"dw-top"},De={class:"dw-date"},Te={key:0,class:"dw-body"},Be={key:1,class:"dw-body"},Ce={class:"dw-word"},He={key:0,class:"dw-pos"},Re={class:"dw-def"},Le={key:1,class:"dw-divider","aria-hidden":"true"},Fe={key:2,class:"dw-ex"},Ue={class:"dw-error-msg"},Pe={class:"dw-foot"},Ve={class:"dw-source"},Oe=["aria-pressed"],qe={key:2,class:"dw-body"},Ne={class:"dw-word"},je={key:0,class:"dw-pos"},Xe={class:"dw-def"},Ye={key:1,class:"dw-divider","aria-hidden":"true"},$e={key:2,class:"dw-ex"},Ge={class:"dw-foot"},Ke={class:"dw-source"},Ze=["aria-pressed"],Je=Q({__name:"DailyWord",setup(U){const t={provider:"EiTake",date:null,term:"Broken",pos:"phrase",definition_en:"This website is broken, and the dev should fix it soon.",definition_ja:"このサイトは不具合があります。開発者が早めに直す必要があります。",example_en:"The daily word could not be loaded today.",example_jp:"今日はデイリーワードを読み込めませんでした。"},x=g(!0),r=g(null),f=g(!1),W=g(null);function k(i){return new Date(i+"T00:00:00").toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function S(){const i=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(new Date),w=i.find(I=>I.type==="year")?.value??"1970",b=i.find(I=>I.type==="month")?.value??"01",z=i.find(I=>I.type==="day")?.value??"01";return`${w}-${b}-${z}`}function D(i){return i.replace(/\s+/g," ").trim()}function C(){f.value=!f.value}const p=A(()=>{const i=W.value,w=f.value?i?.definition_ja||i?.definition_en||t.definition_en:i?.definition_en||t.definition_en,b=f.value?i?.example_jp||i?.example_en||t.example_en:i?.example_en||t.example_en;return i?{provider:i.provider||"EiTake",date:i.date,term:i.term||t.term,pos:i.pos||null,definition:D(w),example:D(b)}:{provider:t.provider,date:t.date,term:t.term,pos:t.pos,definition:f.value?t.definition_ja:t.definition_en,example:f.value?t.example_jp:t.example_en}}),E=A(()=>p.value.date?k(p.value.date):"—");async function M(){x.value=!0,r.value=null;try{const i=S(),{data:w,error:b}=await q.from("daily_word_schedule").select("date, entry_id, term_snapshot").eq("date",i).maybeSingle();if(b)throw b;if(!w)throw new Error(`No daily word scheduled for ${i}.`);const z=w,{data:I,error:T}=await q.from("daily_words").select("id, term, pos, definition_en, definition_ja, example_en, example_jp, created_at, updated_at").eq("id",z.entry_id).maybeSingle();if(T)throw T;if(!I)throw new Error(`Scheduled entry not found (id=${z.entry_id}).`);const v=I;W.value={provider:"EiTake",date:z.date,term:v.term||z.term_snapshot||t.term,pos:v.pos??null,definition_en:v.definition_en??null,definition_ja:v.definition_ja??null,example_en:v.example_en??null,example_jp:v.example_jp??null}}catch(i){const w=i?.message||i?.details||(typeof i=="string"?i:"Unknown error");r.value=w,W.value=null}finally{x.value=!1}}return X(()=>{M()}),(i,w)=>(c(),u("section",Me,[e("header",ze,[e("div",De,y(E.value),1)]),x.value?(c(),u("div",Te,[...w[0]||(w[0]=[e("div",{class:"dw-skel dw-skel-word"},null,-1),e("div",{class:"dw-skel dw-skel-pos"},null,-1),e("div",{class:"dw-skel dw-skel-def"},null,-1),e("div",{class:"dw-skel dw-skel-def"},null,-1)])])):r.value?(c(),u("div",Be,[e("div",Ce,y(p.value.term),1),p.value.pos?(c(),u("div",He,y(p.value.pos),1)):R("",!0),e("div",Re,y(p.value.definition),1),p.value.example?(c(),u("div",Le)):R("",!0),p.value.example?(c(),u("div",Fe,y(p.value.example),1)):R("",!0),e("div",Ue,y(r.value),1),e("footer",Pe,[e("div",Ve," Source: "+y(p.value.provider),1),e("button",{class:"dw-lang-btn",type:"button","aria-pressed":f.value,onClick:C},y(f.value?"EN":"日本語"),9,Oe)])])):(c(),u("div",qe,[e("div",Ne,y(p.value.term),1),p.value.pos?(c(),u("div",je,y(p.value.pos),1)):R("",!0),e("div",Xe,y(p.value.definition),1),p.value.example?(c(),u("div",Ye)):R("",!0),p.value.example?(c(),u("div",$e,y(p.value.example),1)):R("",!0),e("footer",Ge,[e("div",Ke," Source: "+y(p.value.provider),1),e("button",{class:"dw-lang-btn",type:"button","aria-pressed":f.value,onClick:C},y(f.value?"EN":"日本語"),9,Ze)])]))]))}}),Qe=Y(Je,[["__scopeId","data-v-a52cbe71"]]),et={key:0,class:"siw__empty"},tt={key:1,class:"siw__viewport"},at=["src"],st=["src"],ot={key:0,class:"siw__fade","aria-hidden":"true"},nt=Q({__name:"ScrollingImageWall",props:{images:{},tileWidth:{default:96},tileHeight:{default:96},gap:{default:14},visibleCount:{default:0},speedPxPerSec:{default:26},direction:{default:"left"},linkTarget:{default:"_blank"},linkRel:{default:"noopener noreferrer"},edgeFade:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0}},setup(U){const t=U,x=g(null),r=g(0),f=A(()=>Array.isArray(t.images)&&t.images.length>0),W=A(()=>{const n=[];for(const _ of t.images||[])typeof _=="string"?n.push({src:_}):_&&typeof _.src=="string"&&n.push({src:_.src,href:_.href});return n});let k=null;function S(){const n=x.value;n&&(r.value=Math.round(n.getBoundingClientRect().width))}X(()=>{S(),x.value&&"ResizeObserver"in window?(k=new ResizeObserver(()=>S()),k.observe(x.value)):window.addEventListener("resize",S,{passive:!0})}),pe(()=>{k&&x.value&&k.unobserve(x.value),k=null,window.removeEventListener("resize",S),I()});const D=A(()=>{const n=t.tileWidth+t.gap,_=Math.max(1,Math.ceil(Math.max(1,r.value)/Math.max(1,n))+2),m=t.visibleCount&&t.visibleCount>0?t.visibleCount:0;return m>0?Math.max(1,m+2):_}),C=A(()=>{const n=D.value;return n<=1?t.tileWidth:n*t.tileWidth+(n-1)*t.gap}),p=A(()=>{if(!f.value)return[];const n=W.value,_=n.length,m=D.value,F=[];for(let P=0;P<m;P++)F.push(n[P%_]);return F}),E=g(0);let M=null,i=0;const w=A(()=>t.direction==="right"?1:-1);function b(n){i||(i=n);const _=(n-i)/1e3;if(i=n,!v.isDown){const m=Math.max(0,t.speedPxPerSec);E.value+=w.value*m*_,E.value=T(E.value)}M=window.requestAnimationFrame(b)}function z(){M==null&&(i=0,M=window.requestAnimationFrame(b))}function I(){M!=null&&(window.cancelAnimationFrame(M),M=null,i=0)}function T(n){const _=C.value;if(!_||_<=0)return n;let m=n%_;return m>0&&(m-=_),m}X(()=>{z()});const v={isDown:!1,pointerId:-1,startX:0,startOffset:0};function N(n){t.draggable&&f.value&&(n.pointerType==="mouse"&&n.button!==0||(v.isDown=!0,v.pointerId=n.pointerId,v.startX=n.clientX,v.startOffset=E.value,n.currentTarget?.setPointerCapture?.(n.pointerId)))}function o(n){if(!t.draggable||!v.isDown||n.pointerId!==v.pointerId)return;const _=n.clientX-v.startX;E.value=T(v.startOffset+_)}function a(n){t.draggable&&v.isDown&&n.pointerId===v.pointerId&&(v.isDown=!1,v.pointerId=-1)}function h(n,_){if(!_.href||!t.draggable)return;const m=Math.abs(E.value-v.startOffset);(v.isDown||m>6)&&(n.preventDefault(),n.stopPropagation())}const H=A(()=>({"--siw-gap":`${t.gap}px`,"--siw-tile-w":`${t.tileWidth}px`,"--siw-tile-h":`${t.tileHeight}px`})),$=A(()=>({width:`${t.tileWidth}px`,height:`${t.tileHeight}px`})),G=A(()=>({gap:`${t.gap}px`})),K=A(()=>({transform:`translate3d(${E.value}px, 0, 0)`}));return(n,_)=>(c(),u("div",{ref_key:"rootEl",ref:x,class:"siw",style:L(H.value),role:"presentation","aria-hidden":"true",onPointerdown:N,onPointermove:o,onPointerup:a,onPointercancel:a,onPointerleave:a},[f.value?(c(),u("div",tt,[e("div",{class:"siw__track",style:L(K.value)},[e("div",{class:"siw__strip",style:L(G.value)},[(c(!0),u(Z,null,J(p.value,(m,F)=>(c(),de(ce(m.href?"a":"div"),{key:`a-${F}`,class:"siw__tile",style:L($.value),href:m.href||void 0,target:m.href?n.linkTarget:void 0,rel:m.href?n.linkRel:void 0,onClick:P=>h(P,m)},{default:O(()=>[e("img",{class:"siw__img",src:m.src,alt:"",draggable:"false"},null,8,at)]),_:2},1032,["style","href","target","rel","onClick"]))),128))],4),e("div",{class:"siw__strip",style:L(G.value),"aria-hidden":"true"},[(c(!0),u(Z,null,J(p.value,(m,F)=>(c(),de(ce(m.href?"a":"div"),{key:`b-${F}`,class:"siw__tile",style:L($.value),href:m.href||void 0,target:m.href?n.linkTarget:void 0,rel:m.href?n.linkRel:void 0,tabindex:"-1"},{default:O(()=>[e("img",{class:"siw__img",src:m.src,alt:"",draggable:"false"},null,8,st)]),_:2},1032,["style","href","target","rel"]))),128))],4)],4),n.edgeFade?(c(),u("div",ot)):R("",!0)])):(c(),u("div",et))],36))}}),rt=Y(nt,[["__scopeId","data-v-1d762080"]]),it={key:0,class:"ais-muted"},lt={key:1,class:"ais-error"},dt={key:2,class:"ais-scroll",role:"list"},ct={class:"ais-badges","aria-hidden":"true"},ut={key:0,class:"ais-badge ais-badge--xp"},ht={key:1,class:"ais-badge ais-badge--new"},ft=["title","onClick","onKeydown"],pt={class:"ais-icon"},mt=["src","alt","onError"],vt={key:1,class:"ais-icon-fallback","aria-hidden":"true"},_t={class:"ais-name"},wt="public-assets",he="game-icons/",yt=Q({__name:"ActivitiesIconGrid",props:{mode:{default:"both"},width:{default:"100%"},height:{default:"260px"},iconSize:{default:64},titleLines:{default:2},gap:{default:12}},setup(U){const t=U,x=xe(),r=g(!0),f=g(null),W=g([]),k=g(new Set);function S(o){return(o.tags||[]).map(a=>String(a).toLowerCase().trim())}function D(o){const a=S(o);return a.includes("teacher tool")||a.includes("teacher-tool")||a.includes("teachertool")}function C(o){const a=S(o);return a.includes("xp")||a.includes("gives_xp")||a.includes("givesxp")||a.includes("experience")}function p(o){const a=S(o);return o.status&&String(o.status).toLowerCase().trim()==="new"?!0:a.includes("new")||a.includes("recent")}X(async()=>{await Ae(async()=>{try{const{data:o,error:a}=await q.from("activities").select("id, slug, name, type, url_path, external_url, icon_url, thumbnail_url, tags, status, archived_at").is("archived_at",null).order("name",{ascending:!0});if(a)throw a;W.value=o||[]}catch(o){console.error(o),f.value=o?.message??String(o)}finally{r.value=!1}},250)});const E=A(()=>W.value.slice().sort((o,a)=>(o.name||"").localeCompare(a.name||""))),M=A(()=>t.mode==="both"?E.value:t.mode==="tools"?E.value.filter(D):E.value.filter(o=>!D(o)));function i(o){return!!o&&/^[a-z][a-z0-9+\-.]*:\/\//i.test(String(o).trim())}function w(o){if(k.value.has(o.id))return"";const a=o.icon_url||o.thumbnail_url||"";if(!a)return"";if(i(a))return a;let h=String(a).replace(/^\/+/,"");h.startsWith(he)||(h=he+h);const{data:H}=q.storage.from(wt).getPublicUrl(h);return H?.publicUrl||""}function b(o){k.value.add(o)}function z(o){if(!o)return"";let a=String(o).trim();if(!a)return"";if(/^[a-z][a-z0-9+\-.]*:\/\//i.test(a)||/^[a-z][a-z0-9+\-.]*:/i.test(a))return a;if(a.startsWith("//"))return(window.location?.protocol||"https:")+a;/^[\w.-]+\.[a-z]{2,}([/:?#]|$)/i.test(a)&&(a="https://"+a);try{const h=new URL(a,window.location.origin);return!/\.[a-z0-9]+$/i.test(h.pathname.split("/").pop()||"")&&!h.search&&!h.hash&&!h.pathname.endsWith("/")&&(h.pathname+="/"),h.toString()}catch{return a}}function I(o){if(!o)return"";let a=String(o).trim();return a?(a.startsWith("/")||(a="/"+a),a):""}function T(o){if(o.url_path){x.push(I(o.url_path));return}if(o.slug){x.push(`/activities/${o.slug}`);return}if(o.external_url){const a=z(o.external_url);if(a){window.open(a,"_blank","noopener,noreferrer");return}}alert("No activity URL is configured.")}const v=A(()=>Math.max(6,Math.min(24,Math.floor(t.gap||12)))),N=A(()=>({width:t.width,height:t.height,"--ais-icon-base":`${t.iconSize}px`,"--ais-lines":String(t.titleLines),"--ais-gap":`${v.value}px`}));return(o,a)=>(c(),u("section",{class:"ais-root",style:L(N.value),"aria-label":"Activities icon grid"},[r.value?(c(),u("p",it,"Loading…")):f.value?(c(),u("p",lt,y(f.value),1)):(c(),u("div",dt,[(c(!0),u(Z,null,J(M.value,h=>(c(),u("article",{key:h.id,class:"ais-item",role:"listitem"},[e("div",ct,[C(h)?(c(),u("span",ut,"XP")):R("",!0),p(h)?(c(),u("span",ht,"NEW")):R("",!0)]),e("button",{class:"ais-iconBtn",type:"button",title:h.name,onClick:H=>T(h),onKeydown:[ue(te(H=>T(h),["prevent"]),["enter"]),ue(te(H=>T(h),["prevent"]),["space"])]},[e("div",pt,[w(h)?(c(),u("img",{key:0,src:w(h),alt:h.name,loading:"lazy",decoding:"async",draggable:"false",onError:te(H=>b(h.id),["stop"])},null,40,mt)):(c(),u("div",vt))])],40,ft),e("div",_t,y(h.name),1)]))),128))]))],4))}}),fe=Y(yt,[["__scopeId","data-v-a9a47091"]]),gt="data:image/png;base64,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",bt="/TaiyakiEduGames/assets/win_chime-BYEqQxzW.mp3",kt={class:"cap-stack"},At={class:"cap-head"},xt={key:0,class:"cap-error"},It=["disabled"],St=["src"],Et={class:"cap-foot","aria-label":"Community likes counters"},Wt={class:"cap-counters"},Mt={class:"cap-counter"},zt={class:"cap-counter-value"},Dt={class:"cap-counter"},Tt={class:"cap-counter-value"},Bt={class:"cap-counter"},Ct={class:"cap-counter-value"},Ht={class:"cap-counter"},Rt={class:"cap-counter-value"},Lt={class:"cap-burst-layer","aria-hidden":"true"},Ft=3,Ut={__name:"CommunityLikesCounter",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},rowId:{type:String,default:"EiTake"},incrementRpc:{type:String,default:"increment_community_likes"},incrementAmount:{type:Number,default:1},heartSrc:{type:String,default:gt},useDirectUpdate:{type:Boolean,default:!1}},setup(U){const t=U,x=A(()=>({width:t.width,height:t.height})),r=g({total:0,daily_total:0,weekly_total:0,monthly_total:0}),f=g(!1),W=g(!1),k=g(""),S=g(""),D=["anim-bounce","anim-spin","anim-wiggle","anim-pop","anim-squash","anim-float"],C=g(!1),p=g([]);let E=1,M=[],i={x:null,y:null};const w=g(null),b=g([]);let z=!1,I=0;function T(){try{const s=[];for(let l=0;l<Ft;l++){const d=new Audio(bt);d.preload="auto",d.volume=1,s.push(d)}b.value=s}catch{}}function v(){if(z||!b.value.length)return;const s=b.value;let l=0;for(const d of s)try{const ee=d.volume;d.volume=0,d.currentTime=0;const V=d.play();V&&typeof V.then=="function"&&V.then(()=>{d.pause(),d.currentTime=0,d.volume=ee,l++,l>=s.length&&(z=!0)}).catch(()=>{})}catch{}}function N(){const s=b.value;if(!s.length)return;const l=s[I];I=(I+1)%s.length;try{l.currentTime=0,l.play()}catch{}}function o(s){return Number(s??0).toLocaleString()}async function a(){k.value="";const{data:s,error:l}=await q.from("community_likes").select("total,daily_total,weekly_total,monthly_total").eq("id",t.rowId).single();if(l){k.value=`Failed to load community likes. (${l.message})`;return}r.value={total:Number(s?.total??0),daily_total:Number(s?.daily_total??0),weekly_total:Number(s?.weekly_total??0),monthly_total:Number(s?.monthly_total??0)},f.value=!0}function h(s){r.value.total=Number(r.value.total??0)+s,r.value.daily_total=Number(r.value.daily_total??0)+s,r.value.weekly_total=Number(r.value.weekly_total??0)+s,r.value.monthly_total=Number(r.value.monthly_total??0)+s}async function H(){if(!t.useDirectUpdate){const{error:l}=await q.rpc(t.incrementRpc,{p_id:t.rowId,p_amount:t.incrementAmount});if(l)throw l;return}const{error:s}=await q.from("community_likes").update({total:Number(r.value.total??0)}).eq("id",t.rowId);if(s)throw s}function $(){return D[Math.floor(Math.random()*D.length)]}function G(s){!s||C.value||(C.value=!0,S.value="",s.offsetWidth,S.value=$())}function K(s,l,d){return Math.max(l,Math.min(d,s))}function n(s){v(),s&&typeof s.clientX=="number"&&typeof s.clientY=="number"&&(i={x:s.clientX,y:s.clientY})}function _(){}function m(){C.value=!1,S.value=""}function F(s){if(s&&typeof s.clientX=="number"&&typeof s.clientY=="number")return{x:s.clientX,y:s.clientY};const l=w.value;if(l){const d=l.getBoundingClientRect();return{x:d.left+d.width/2,y:d.top+d.height/2}}return i.x!=null?{x:i.x,y:i.y}:{x:window.innerWidth/2,y:window.innerHeight/2}}function P(s,l){const d=10+Math.floor(Math.random()*5),ee=Date.now();for(let V=0;V<d;V++){const ae=-Math.PI/2+Math.random()*Math.PI,se=35+Math.random()*65,ve=Math.cos(ae)*se+(Math.random()*26-13),_e=Math.sin(ae)*se-(45+Math.random()*70),oe=900+Math.floor(Math.random()*650),ne=2200+Math.floor(Math.random()*1500),re=Math.floor(Math.random()*140),we=10+Math.floor(Math.random()*14),ye=Math.floor(Math.random()*220-110),ge=(.45+Math.random()*.35).toFixed(2),ie=`${ee}-${E++}-${V}`;p.value.push({id:ie,x:s,y:l,dx:ve,dy:_e,rot:ye,durUp:oe,durFall:ne,delay:re,size:we,alpha:ge});const be=window.setTimeout(()=>{const le=p.value.findIndex(ke=>ke.id===ie);le!==-1&&p.value.splice(le,1)},oe+ne+re+160);M.push(be)}}async function me(s){if(W.value||!f.value)return;W.value=!0,k.value="",N();const l=F(s);P(K(l.x,0,window.innerWidth),K(l.y,0,window.innerHeight)),await Se(),G(w.value),h(t.incrementAmount);try{await H()}catch(d){h(-t.incrementAmount),k.value=`Could not send like. (${d?.message||"Unknown error"})`}finally{W.value=!1}}return X(async()=>{T(),await a()}),pe(()=>{for(const s of M)window.clearTimeout(s);M=[];for(const s of b.value)try{s.pause(),s.src=""}catch{}b.value=[]}),(s,l)=>(c(),u("section",{class:"cap-root",style:L(x.value),onPointerdown:n},[e("div",kt,[e("header",At,[l[0]||(l[0]=e("p",{class:"cap-subtitle"},"Tap the heart to show some love!",-1)),l[1]||(l[1]=e("div",{class:"cap-micro"}," If EiTake has every been of help, click the heart to let us know! ",-1)),k.value?(c(),u("div",xt,y(k.value),1)):R("",!0)]),e("button",{ref_key:"heartBtnEl",ref:w,class:Ie(["cap-heart-btn",[W.value?"is-busy":"",S.value]]),type:"button",disabled:W.value||!f.value,onClick:me,onAnimationstart:_,onAnimationend:m,"aria-label":"Send a community like",title:"Send a like"},[e("img",{class:"cap-heart-img",src:t.heartSrc,alt:"",draggable:"false"},null,8,St)],42,It),e("footer",Et,[e("div",Wt,[e("div",Mt,[l[2]||(l[2]=e("div",{class:"cap-counter-label"},"Total Likes",-1)),e("div",zt,y(o(r.value.total)),1)]),e("div",Dt,[l[3]||(l[3]=e("div",{class:"cap-counter-label"},"Today",-1)),e("div",Tt,y(o(r.value.daily_total)),1)]),e("div",Bt,[l[4]||(l[4]=e("div",{class:"cap-counter-label"},"This Week",-1)),e("div",Ct,y(o(r.value.weekly_total)),1)]),e("div",Ht,[l[5]||(l[5]=e("div",{class:"cap-counter-label"},"This Month",-1)),e("div",Rt,y(o(r.value.monthly_total)),1)])])])]),e("div",Lt,[(c(!0),u(Z,null,J(p.value,d=>(c(),u("span",{key:d.id,class:"cap-burst-heart",style:L({left:d.x+"px",top:d.y+"px","--dx":d.dx+"px","--dy":d.dy+"px","--rot":d.rot+"deg","--durUp":d.durUp+"ms","--durFall":d.durFall+"ms","--delay":d.delay+"ms","--size":d.size+"px","--alpha":d.alpha})}," ❤ ",4))),128))])],36))}},Pt=Y(Ut,[["__scopeId","data-v-b5b93ded"]]),Vt={class:"dashboard"},Ot={class:"dashboard__content"},qt={class:"dashboard__grid","aria-label":"Dashboard sections"},Nt={class:"dashboard__card dashboard__card--wotd","aria-label":"Word of the Day"},jt={class:"dashboard__cardBody dashboard__cardBody--padded"},Xt={class:"dashboard__card dashboard__card--games","aria-label":"Games"},Yt={class:"dashboard__cardHead"},$t={class:"dashboard__cardTitle"},Gt={class:"dashboard__cardBody"},Kt={class:"dashboard__card dashboard__card--teacherTools","aria-label":"Teacher Tools"},Zt={class:"dashboard__cardHead"},Jt={class:"dashboard__cardTitle"},Qt={class:"dashboard__cardBody"},ea={class:"dashboard__card dashboard__card--textbooks","aria-label":"Textbooks"},ta={class:"dashboard__cardHead dashboard__cardHead--split"},aa={class:"dashboard__cardTitle"},sa={class:"dashboard__headRight"},oa={class:"dashboard__cardBody dashboard__cardBody--wall"},na={class:"dashboard__card dashboard__card--community","aria-label":"Community"},ra={class:"dashboard__cardBody"},ia={class:"dashboard__footer","aria-label":"Footer"},la={class:"dashboard__footerLeft"},da=Q({__name:"Dashboard",setup(U){const t=[{src:new URL("/TaiyakiEduGames/assets/lets-try-1-2018-DVefs5yw.png",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/lets-try-2-2018-DQfTaW9M.png",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/new-horizon-5-2024-BaGMM3ni.jpg",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/new-horizon-6-2024-Bc9NvqnJ.jpg",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/my-picture-dictionary-new-horizon-2024-r3dztHYG.jpg",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/new-crown-1-2025-DTUBlV8S.png",import.meta.url).href},{src:new URL("/TaiyakiEduGames/assets/holidays-BVDa_wRL.png",import.meta.url).href}];return(x,r)=>{const f=Ee("RouterLink");return c(),u("main",Vt,[e("div",Ot,[e("section",qt,[e("section",Nt,[r[0]||(r[0]=e("header",{class:"dashboard__cardHead"},[e("h2",{class:"dashboard__cardTitle"},"Word of the Day")],-1)),e("div",jt,[B(Qe)])]),e("section",Xt,[e("header",Yt,[e("h2",$t,[B(f,{class:"dashboard__titleLink",to:"/activities"},{default:O(()=>[...r[1]||(r[1]=[j("Games",-1)])]),_:1})])]),e("div",Gt,[B(fe,{mode:"games",width:"100%",height:"100%"})])]),e("section",Kt,[e("header",Zt,[e("h2",Jt,[B(f,{class:"dashboard__titleLink",to:"/activities"},{default:O(()=>[...r[2]||(r[2]=[j("Teacher Tools",-1)])]),_:1})])]),e("div",Qt,[B(fe,{mode:"tools",width:"100%",height:"100%"})])]),e("section",ea,[e("header",ta,[e("h2",aa,[B(f,{class:"dashboard__titleLink",to:"/textbooks"},{default:O(()=>[...r[3]||(r[3]=[j("Textbooks & Flashcard Games",-1)])]),_:1})]),e("div",sa,[B(We,{"max-height":30,scale:.7})])]),e("div",oa,[B(rt,{images:t,"tile-width":200,"tile-height":300,gap:0,"speed-px-per-sec":30,direction:"left","visible-count":5,draggable:!0})])]),e("section",na,[r[4]||(r[4]=e("header",{class:"dashboard__cardHead"},[e("h2",{class:"dashboard__cardTitle"},"Community")],-1)),e("div",ra,[B(Pt)])])])]),e("footer",ia,[e("div",la,[B(f,{class:"dashboard__footerLink",to:"/terms"},{default:O(()=>[...r[5]||(r[5]=[j("Terms of Service",-1)])]),_:1}),r[7]||(r[7]=e("span",{class:"dashboard__footerDot","aria-hidden":"true"},"•",-1)),B(f,{class:"dashboard__footerLink",to:"/privacy-policy"},{default:O(()=>[...r[6]||(r[6]=[j("Privacy Policy",-1)])]),_:1})]),r[8]||(r[8]=e("div",{class:"dashboard__footerRight"},[e("a",{class:"dashboard__brandLink",href:"https://griffiigames.com",target:"_blank",rel:"noopener noreferrer"}," Griffii Games ")],-1))])])}}}),ua=Y(da,[["__scopeId","data-v-6dd3dbec"]]);export{ua as default};
