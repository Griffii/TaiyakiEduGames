import{i as Ee,r,c as k,o as $e,a as v,g as N,d as e,h as I,f as B,t as m,k as we,v as ke,T as Se,F as w,e as $,p as Me,b as c,n as J,_ as Ae,j as Ye,C as Ue,u as Ve,x as ve,B as fe,O as xe}from"./index-BsuP6KVQ.js";import{b as He}from"./back-icon-xKqy7r3s.js";import{s as qe}from"./settings-icon-DJLQOoae.js";import{h as ze,w as We}from"./shokichi-KW1WytDh.js";const Xe="/TaiyakiEduGames/assets/mystery-machine-icon-DFeu74Q1.png",Ke="/TaiyakiEduGames/assets/mystery-machine-body-D8HKPlGZ.png",je="/TaiyakiEduGames/assets/slot-arm-christmas-42_i7_I_.png",Je="/TaiyakiEduGames/assets/slot-machine-DpezDdAa.mp3",Oe="/TaiyakiEduGames/assets/daikichi-C_c_FTXQ.mp3",Pe="/TaiyakiEduGames/assets/daikyo-CY7yqnN5.mp3",Qe="/TaiyakiEduGames/assets/kichi--kgZ_B-c.mp3",Ie="/TaiyakiEduGames/assets/kyo-B7Jx3MGi.mp3",Ze={class:"mm-stage"},et={class:"mm-machine"},tt={class:"mm-stack"},at={class:"mm-top-panel"},st={class:"wager-section"},lt={class:"wager-inner"},ot={class:"wager-header"},nt={class:"wager-controls"},it=["disabled"],rt={class:"wager-value-block"},ut={class:"wager-amount"},ct=["disabled"],dt={class:"mm-toast-panel"},vt={key:"toast",class:"mm-toast"},ft={class:"mm-toast-text"},pt={class:"reels-layer"},mt={class:"slot-frame"},yt={class:"reel-symbol"},gt=["src"],bt=["disabled","aria-disabled"],ht=["src"],_t={key:0,class:"effect-modal"},wt={class:"effect-header"},kt={class:"effect-title"},St={class:"effect-body"},Mt={class:"effect-description"},xt={class:"effect-actions"},Ct={class:"effect-modal info-modal"},Tt={class:"prize-grid"},Et={class:"prize-col"},$t={class:"prize-list"},At={class:"prize-col"},zt={class:"prize-list"},Wt={class:"prize-col"},Ot={class:"prize-list"},Pt={class:"prize-col"},It={class:"prize-list"},Nt={class:"effect-actions info-actions"},Bt=48,Ce=3500,Dt=Ee({__name:"MysteryMachine",props:{maxWager:{}},emits:["close","resolved"],setup(me,{emit:U}){const le=Ke,oe=je;let S=null;const M=new Map;typeof window<"u"&&typeof Audio<"u"&&(S=new Audio(Je),M.set("return",ze),M.set("quadruple",Oe),M.set("lose_all",Pe),M.set("double",Qe),M.set("lose_half",Ie),M.set("triple",We));function ne(){if(S)try{S.currentTime=0,S.play().catch(()=>{})}catch{}}function ie(o){const s=M.get(o);if(s)try{const l=new Audio(s);l.currentTime=0,l.play().catch(()=>{})}catch{}}const b=me,A=U,i=r(10),x=["ðŸ’£","âš–ï¸","â­•","âœ¨","ðŸ†","7ï¸âƒ£"],C={lose_all:"ðŸ’£",lose_half:"â­•",return:"âš–ï¸",double:"âœ¨",triple:"ðŸ†",quadruple:"7ï¸âƒ£"},D=360/x.length,Q=[2300,2900,3400],T=r([0,0,0]),y=r(!1),V=r(!1),H=r(!1),q=r(null),g=r(null),Z=r(0),f=r(!1),z=r(!1),F=r(!1),G=r(""),_=[{id:"t1_refip",tier:1,label:"One re-flip (must take second card)"},{id:"t1_flip2pick1",tier:1,label:"Flip 2 cards and pick 1"},{id:"t1_steal10_each",tier:1,label:"Steal 10 points from each team"},{id:"t1_give10_one",tier:1,label:"Give away 10 points to one team"},{id:"t1_half_next",tier:1,label:"Your next card's value is halved"}],X=[{id:"t2_steal20_each",tier:2,label:"Steal 20 points from each team"},{id:"t2_double_next",tier:2,label:"Your next card's value is doubled"},{id:"t2_convert_negative",tier:2,label:"Convert a negative card to a positive card"},{id:"t2_swap_second",tier:2,label:"Swap total points with the 2nd place team"},{id:"t2_give50_one",tier:2,label:"Choose another team to get 50 points"}],W=[{id:"t3_steal30_each",tier:3,label:"Steal 30 points from each team"},{id:"t3_steal50_one",tier:3,label:"Steal 50 points from one team"},{id:"t3_lose30_others",tier:3,label:"Every other team loses 30 points"},{id:"t3_flip3_pick2",tier:3,label:"Flip 3 cards and choose 2 next turn"},{id:"t3_plus50_others",tier:3,label:"Plus 50 points to every other team"},{id:"t3_give10_others",tier:3,label:"Give 10 points to every other team"}],re={t1_refip:"Use once: if you dislike your next card, flip a new one â€” but you must take the second card.",t1_flip2pick1:"On a future turn, flip 2 cards instead of 1 and choose which card to keep.",t1_steal10_each:"Immediately steal 10 points from every other team and add them to your own score.",t1_give10_one:"Immediately give 10 of your points to any one team of your choice.",t1_half_next:"Your next cardâ€™s value is cut in half!",t2_steal20_each:"Steal 20 points from every other team and add them all to your score.",t2_double_next:"The next card you draw will be worth double its normal value.",t2_convert_negative:"Turn a negative card into a positive card of the same value.",t2_swap_second:"Swap your total score with the team currently in 2nd place.",t2_give50_one:"Gift +50 points to any one team.",t3_steal30_each:"Steal a huge 30 points from every other team.",t3_steal50_one:"Steal 50 points from any single team.",t3_lose30_others:"Every other team immediately loses 30 points from their total.",t3_flip3_pick2:"On a future turn, flip 3 cards and keep 2 of them. Discard the 3rd.",t3_plus50_others:"Every other team gains +50 points.",t3_give10_others:"Give 10 of your points to every other team."},R=[{type:"lose_all",weight:22},{type:"lose_half",weight:18},{type:"return",weight:25},{type:"double",weight:18},{type:"triple",weight:10},{type:"quadruple",weight:7}],O=[],E=k(()=>!(y.value||i.value<10||i.value%10!==0||b.maxWager!=null&&i.value>b.maxWager)),K=k(()=>!!g.value&&!!q.value&&!y.value),ee=k(()=>t(i.value)),ue=k(()=>g.value?re[g.value.id]??g.value.label:"");function te(o){switch(o){case"lose_all":return"Lose all wager";case"lose_half":return"Lose half wager";case"return":return"No change (return wager)";case"double":return"Double wager";case"triple":return"Triple wager";case"quadruple":return"Quadruple wager"}}const ce=k(()=>{const o=R.reduce((s,l)=>s+l.weight,0);return R.map(({type:s,weight:l})=>{const u=l/o*100;return{type:s,name:te(s),percent:u.toFixed(1)}})});function L(){i.value<0&&(i.value=0),b.maxWager!=null&&i.value>b.maxWager&&(i.value=b.maxWager),i.value%10!==0&&(i.value=Math.round(i.value/10)*10)}function t(o){return o>=100?3:o>=50?2:1}function a(o){const s=o===1?_:o===2?X:W,l=Math.floor(Math.random()*s.length);return s[l]}function n(){const o=R.reduce((u,Y)=>u+Y.weight,0),s=Math.random()*o;let l=0;for(const u of R)if(l+=u.weight,s<=l)return u.type;return"return"}function d(o,s){let l="",u=0;switch(o){case"lose_all":l="You lost your entire wager",u=-s;break;case"lose_half":l="You lost half your wager",u=-Math.round(s/2);break;case"return":l="Your wager was returned (no change)",u=0;break;case"double":l="Your wager was doubled",u=s;break;case"triple":l="Your wager was tripled",u=2*s;break;case"quadruple":l="Your wager was quadrupled",u=3*s;break}return{outcome:{type:o,label:l},delta:u}}function P(o){const l=`rotateX(${T.value[o]}deg)`;if(V.value)return{transform:l,transition:"transform 0s"};if(y.value){const u=Q[o]??Ce;return{transform:l,transition:`transform ${u}ms cubic-bezier(.2,.8,.3,1.1)`}}return{transform:l,transition:"transform 0s"}}function p(o){return{transform:`rotateX(${o*D}deg) translateZ(${Bt}px)`}}function h(o,s){const l=o===0?"0 points":`${o>0?"+":""}${o} points`;G.value=l,F.value=!0,ie(s)}function de(){F.value=!1}function ae(){if(!E.value)return;L(),q.value=null,g.value=null,Z.value=0,f.value=!1,F.value=!1;const o=n(),{outcome:s,delta:l}=d(o,i.value),u=t(i.value),Y=a(u),se=C[o],he=x.indexOf(se),Fe=he>=0?he:0;y.value=!1,V.value=!0,T.value=[0,0,0];try{document.body.offsetHeight}catch{}window.requestAnimationFrame(()=>{V.value=!1,y.value=!0;const Ge=3;T.value=T.value.map((_e,Le)=>-((Ge+Le)*360+Fe*D));const Re=window.setTimeout(()=>{q.value=s,g.value=Y,Z.value=l,y.value=!1;const _e={wager:i.value,wagerOutcome:s,pointsDelta:l,tier:u,effect:Y};A("resolved",_e),h(l,s.type)},Ce);O.push(Re)})}function Ne(){if(!E.value||y.value)return;H.value=!0,ne();const o=window.setTimeout(()=>{H.value=!1},350);O.push(o),ae()}function ye(o){y.value||(i.value+=o,i.value<0&&(i.value=0),L())}function Be(){!K.value||!g.value||(f.value=!0)}function ge(){f.value=!1}function be(){A("close")}function De(){be()}return $e(()=>{O.forEach(o=>clearTimeout(o))}),(o,s)=>(c(),v("section",{class:"mystery-machine-overlay",role:"dialog","aria-modal":"true",onClick:N(De,["self"])},[e("button",{class:"overlay-prizes-btn",type:"button",onClick:s[0]||(s[0]=l=>z.value=!0),"aria-label":"View prize tiers"}," ðŸŽ "),e("button",{class:"overlay-close-btn",type:"button",onClick:be,"aria-label":"Close Mystery Machine"}," âœ• "),e("div",Ze,[e("section",et,[e("div",tt,[e("div",at,[e("section",st,[e("div",lt,[e("div",ot,[s[5]||(s[5]=e("span",{class:"wager-label"},"Wager",-1)),e("span",{class:B(["wager-tier-pill",`tier-${ee.value}`])}," Tier "+m(ee.value),3)]),e("div",nt,[e("button",{type:"button",class:"arrow-btn",onClick:s[1]||(s[1]=l=>ye(-10)),disabled:y.value||i.value<=0,"aria-label":"Decrease wager"}," â—€ ",8,it),e("div",rt,[e("span",ut,m(i.value)+" pts ",1)]),e("button",{type:"button",class:"arrow-btn",onClick:s[2]||(s[2]=l=>ye(10)),disabled:y.value||o.maxWager!=null&&i.value>=o.maxWager,"aria-label":"Increase wager"}," â–¶ ",8,ct)])])])]),e("div",dt,[we(Se,{name:"mm-toast-slide"},{default:ke(()=>[F.value?(c(),v("div",vt,[e("span",ft,m(G.value),1),e("button",{class:"mm-toast-close",type:"button",onClick:de,"aria-label":"Dismiss message"}," âœ• ")])):I("",!0)]),_:1})]),e("div",pt,[e("div",mt,[(c(!0),v(w,null,$(T.value,(l,u)=>(c(),v("div",{key:u,class:"reel3d"},[e("div",{class:"reel3d-inner",style:J(P(u))},[(c(),v(w,null,$(x,(Y,se)=>e("div",{key:se,class:"reel-face",style:J(p(se))},[e("span",yt,m(Y),1)],4)),64))],4)]))),128))])]),e("img",{src:Me(le),alt:"Mystery Machine body",class:"machine-body-img",draggable:"false"},null,8,gt),K.value&&!f.value?(c(),v("button",{key:0,class:B(["prize-btn",{"has-prize":K.value}]),type:"button",onClick:Be},[...s[6]||(s[6]=[e("span",{class:"prize-label"},"ðŸŽ Mystery Prize",-1)])],2)):I("",!0),e("button",{class:"slot-arm-btn",type:"button",disabled:!E.value||y.value,onClick:Ne,"aria-disabled":!E.value||y.value},[e("img",{src:Me(oe),alt:"Pull to spin",class:B(["slot-arm-img",{"is-disabled":!E.value||y.value,"is-pulled":H.value}]),draggable:"false"},null,10,ht)],8,bt)])])]),f.value&&g.value?(c(),v("div",{key:0,class:"effect-modal-overlay",onClick:N(ge,["self"])},[we(Se,{name:"mm-card-pop"},{default:ke(()=>[f.value?(c(),v("div",_t,[e("div",wt,[e("h3",kt,m(g.value.label),1)]),e("div",St,[e("p",Mt,m(ue.value),1)]),e("div",xt,[e("span",{class:B(["effect-tier-chip",`tier-${g.value.tier}`])}," Tier "+m(g.value.tier),3),e("button",{class:"pill-btn primary",type:"button",onClick:ge}," Close ")])])):I("",!0)]),_:1})])):I("",!0),z.value?(c(),v("div",{key:1,class:"effect-modal-overlay",onClick:s[4]||(s[4]=N(l=>z.value=!1,["self"]))},[e("div",Ct,[s[11]||(s[11]=e("h3",{class:"effect-title"},"Prizes & Outcomes",-1)),e("div",Tt,[e("div",Et,[s[7]||(s[7]=e("h4",null,"Wager Outcomes",-1)),e("ul",$t,[(c(!0),v(w,null,$(ce.value,l=>(c(),v("li",{key:l.type},m(l.name)+" â€” approx "+m(l.percent)+"% ",1))),128))])]),e("div",At,[s[8]||(s[8]=e("h4",null,"Tier 1 (10â€“40)",-1)),e("ul",zt,[(c(),v(w,null,$(_,l=>e("li",{key:l.id},m(l.label),1)),64))])]),e("div",Wt,[s[9]||(s[9]=e("h4",null,"Tier 2 (50â€“90)",-1)),e("ul",Ot,[(c(),v(w,null,$(X,l=>e("li",{key:l.id},m(l.label),1)),64))])]),e("div",Pt,[s[10]||(s[10]=e("h4",null,"Tier 3 (100+)",-1)),e("ul",It,[(c(),v(w,null,$(W,l=>e("li",{key:l.id},m(l.label),1)),64))])])]),e("div",Nt,[e("button",{class:"pill-btn primary",type:"button",onClick:s[3]||(s[3]=l=>z.value=!1)}," Close ")])])])):I("",!0)]))}}),Ft=Ae(Dt,[["__scopeId","data-v-d1eb45ab"]]),Gt="/TaiyakiEduGames/assets/mystery-machine-a5NpraJ-.mp3",Rt=["aria-expanded"],Lt={class:"menu-row"},Yt={class:"menu-row"},Ut={class:"menu-row"},Vt={class:"mute-row"},Ht=["aria-pressed"],qt={class:"label-cell row"},Xt=["onClick","onKeydown"],Kt={class:"face back"},pe=4,j=6,jt=.35,Te="random-points-settings",Jt=150,Qt=110,Zt=Ee({__name:"RandomPoints",setup(me){const U=r(!1),le=r(null);function oe(){U.value=!1}const S=pe*j,M=["A","B","C","D","E","F"],ne=Ve(),ie=()=>ne.back(),b=r(!1),A=r(!0),i=r(!1),x=r(!0);r(!1);const C=r(!1),D=r(Array.from({length:S},(t,a)=>({id:a,value:0,display:"",revealed:!1}))),Q=r(typeof window<"u"?window.innerHeight:800),T=r(typeof window<"u"?window.innerWidth:1280),y=k(()=>{const t=T.value;return t<=360?22:t<=420?24:t<=520?26:t<=680?28:30}),V=k(()=>{const t=T.value;return t<=360?6:t<=420?7:t<=520?8:t<=680?9:10}),H=k(()=>({"--labelW":`${y.value}px`,"--gap":`${V.value}px`})),q=k(()=>({height:`${Math.max(320,Q.value-Jt-Qt)}px`,gridTemplateColumns:`var(--labelW) repeat(${j}, 1fr)`,gridTemplateRows:`repeat(${pe}, 1fr)`,gap:"var(--gap)"})),g=k(()=>({gridTemplateColumns:`var(--labelW) repeat(${j}, 1fr)`,gap:"var(--gap)"})),Z=(t,a)=>(t-1)*j+(a-1),f=(t,a)=>D.value[Z(t,a)],z=t=>typeof t!="number";function F(t){return typeof t=="number"?t>0?"val-pos":t<0?"val-neg":"val-zero":"val-mystery val-text"}function G(t,a){return Math.floor(Math.random()*(a-t+1))+t}const _={positive:new Audio(We),negative:new Audio(Ie),swap:new Audio(ze),loseAll:new Audio(Pe),fifty:new Audio(Oe),mystery:new Audio(Gt)};function X(){const t=C.value?0:jt;_.positive.volume=t,_.negative.volume=t,_.swap.volume=t,_.loseAll.volume=t,_.fifty.volume=t,_.mystery.volume=t}function W(t){const a=_[t];try{a.currentTime=0,a.play()}catch{}}function re(){C.value=!C.value,X(),te()}function R(){const t=[],a=i.value?100:50;if(t.push(a),x.value){const p=S-t.length;if(p>0){const h=G(3,6),de=Math.min(h,p);for(let ae=0;ae<de;ae++)t.push("Mystery Machine")}}const n=S-t.length;let d=n,P=0;A.value&&(d=Math.floor(n*.6),P=n-d);for(let p=0;p<d;p++){const h=5*G(1,5);t.push(i.value?h*2:h)}for(let p=0;p<P;p++){const h=-5*G(1,5);t.push(i.value?h*2:h)}for(let p=t.length-1;p>0;p--){const h=Math.floor(Math.random()*(p+1));[t[p],t[h]]=[t[h],t[p]]}return t}function O(){const t=R();for(let a=0;a<S;a++){const n=t[a],d=D.value[a];d.value=n,d.display=typeof n=="number"?String(n):n,d.revealed=!1}}function E(t){if(!(!t||t.revealed)){if(typeof t.value=="string")W("mystery");else{const a=i.value?100:50;t.value===a?W("fifty"):t.value>0?W("positive"):W("negative")}t.revealed=!0}}function K(){for(const t of D.value)t.revealed=!0}function ee(){O()}function ue(){b.value=!b.value}function te(){localStorage.setItem(Te,JSON.stringify({allowNegatives:A.value,doublePoints:i.value,allowSpecial:x.value,sfxMuted:C.value}))}function ce(){te(),O(),b.value=!1}function L(){Q.value=window.innerHeight,T.value=window.innerWidth}return Ye(()=>{try{const t=localStorage.getItem(Te);if(t){const a=JSON.parse(t);typeof a.allowNegatives=="boolean"&&(A.value=a.allowNegatives),typeof a.doublePoints=="boolean"&&(i.value=a.doublePoints),typeof a.allowSpecial=="boolean"&&(x.value=a.allowSpecial),typeof a.sfxMuted=="boolean"&&(C.value=a.sfxMuted)}}catch{}X(),O(),L(),window.addEventListener("resize",L,{passive:!0})}),$e(()=>{window.removeEventListener("resize",L)}),(t,a)=>(c(),v("section",{class:"random-points-page app-bg",style:J(H.value)},[e("button",{class:"icon-btn back",type:"button",onClick:ie,"aria-label":"Back",title:"Back"},[...a[6]||(a[6]=[e("img",{class:"icon",src:He,alt:""},null,-1)])]),e("button",{class:"icon-btn settings",type:"button",onClick:ue,"aria-haspopup":"dialog","aria-expanded":b.value,"aria-controls":"settings-menu","aria-label":"Open settings",title:"Settings"},[...a[7]||(a[7]=[e("img",{class:"icon",src:qe,alt:""},null,-1)])],8,Rt),e("button",{class:"icon-btn mystery",type:"button",onClick:a[0]||(a[0]=n=>U.value=!0),"aria-label":"Open Mystery Machine",title:"Mystery Machine"},[...a[8]||(a[8]=[e("img",{class:"icon",src:Xe,alt:""},null,-1)])]),U.value?(c(),Ue(Ft,{key:0,maxWager:le.value,onClose:oe},null,8,["maxWager"])):I("",!0),b.value?(c(),v("div",{key:1,class:"settings-overlay",role:"presentation",onClick:a[5]||(a[5]=n=>b.value=!1)},[e("div",{id:"settings-menu",class:"settings-menu",role:"dialog","aria-modal":"true",onClick:a[4]||(a[4]=N(()=>{},["stop"]))},[a[12]||(a[12]=e("h3",{class:"menu-title"},"Settings",-1)),e("label",Lt,[ve(e("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=n=>A.value=n)},null,512),[[fe,A.value]]),a[9]||(a[9]=e("span",null,"Negative Numbers",-1))]),e("label",Yt,[ve(e("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=n=>i.value=n)},null,512),[[fe,i.value]]),a[10]||(a[10]=e("span",null,"Double Points",-1))]),e("label",Ut,[ve(e("input",{type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=n=>x.value=n)},null,512),[[fe,x.value]]),a[11]||(a[11]=e("span",null,"Mystery Machine Cards",-1))]),e("div",Vt,[e("button",{class:"mute-btn","aria-pressed":C.value,onClick:re},m(C.value?"Unmute SFX":"Mute SFX"),9,Ht)]),e("button",{class:"apply",onClick:ce},"Apply")])])):I("",!0),a[15]||(a[15]=e("h1",{class:"title"},"Random Points",-1)),e("div",{class:"labels",style:J(g.value)},[a[13]||(a[13]=e("div",null,null,-1)),(c(),v(w,null,$(M,n=>e("div",{key:n,class:"label-cell"},m(n),1)),64))],4),e("div",{class:"grid",style:J(q.value)},[(c(),v(w,null,$(pe,n=>(c(),v(w,{key:`r-${n}`},[e("div",qt,m(n),1),(c(),v(w,null,$(j,d=>e("div",{key:`c-${n}-${d}`,class:"grid-item"},[e("div",{class:B(["card",{"mystery-card":z(f(n,d).value),"mystery-card--revealed":z(f(n,d).value)&&f(n,d).revealed}]),role:"button",tabindex:"0",onClick:N(P=>E(f(n,d)),["stop"]),onKeydown:[xe(N(P=>E(f(n,d)),["prevent"]),["enter"]),xe(N(P=>E(f(n,d)),["prevent"]),["space"])]},[e("div",{class:B(["flip-inner",{revealed:f(n,d).revealed}])},[a[14]||(a[14]=e("div",{class:"face front"},null,-1)),e("div",Kt,[e("span",{class:B(["value",F(f(n,d).value)])},m(f(n,d).display),3)])],2)],42,Xt)])),64))],64))),64))],4),e("div",{class:"controls"},[e("button",{class:"big-btn",onClick:ee},"Reset"),e("button",{class:"big-btn",onClick:K},"See All")])],4))}}),na=Ae(Zt,[["__scopeId","data-v-c4b83d76"]]);export{na as default};
