import{d as B,r as d,c as n,B as C,o as S,Q as O,g as P,a as i,b as s,v as F,t as f,e as G,K as J,F as Z,h as Q,u as V,s as w,f as o,_ as X}from"./index-BMgXBjWP.js";const j={class:"page activity-runner"},K=["src"],_={class:"head title-head"},$={class:"title"},ee={class:"content runner-content"},te=["src"],ae={key:1,class:"empty"},se={class:"muted"},le={key:0,class:"tags"},ne={class:"chips"},ie=B({__name:"ActivityRunner",setup(oe){const Y=new URL("data:image/png;base64,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",import.meta.url).toString(),N=V();function I(){N.push("/dashboard")}const r=C(),A=d(null),h=d(null),c=n(()=>r.params.slug),b=n(()=>r.params.id),W=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,u=(r.meta??{}).activity??void 0,l=d(null),p=d(!1),v=d(null);async function k(){if(v.value=null,l.value=null,!w)return;const t=b.value||c.value||u?.slug;if(t){p.value=!0;try{let e;if(W.test(t)?e=await w.from("activities").select("id,slug,name,type,url_path,external_url,icon_url,thumbnail_url,tags,launch_params,status,archived_at").eq("id",t).maybeSingle():e=await w.from("activities").select("id,slug,name,type,url_path,external_url,icon_url,thumbnail_url,tags,launch_params,status,archived_at").eq("slug",t).maybeSingle(),e.error)throw e.error;l.value=e.data??null,l.value||(v.value="Activity not found.")}catch(e){v.value=e?.message||"Failed to load activity."}finally{p.value=!1}}}S(k),O([c,b],()=>k());function z(){const t=r.query?.tags;return t?Array.isArray(t)?t.flatMap(e=>String(e).split(",")).map(e=>e.trim()).filter(Boolean):String(t).split(",").map(e=>e.trim()).filter(Boolean):[]}const U=n(()=>l.value?.name??u?.name??u?.title??(c.value?c.value.replace(/-/g," "):"Activity")),R=n(()=>(l.value?.tags??u?.tags??z()??[]).filter(Boolean));function x(t){if(!t)return"";let e=String(t).trim();if(!e)return"";if(/^[a-z][a-z0-9+\-.]*:\/\//i.test(e)||/^[a-z][a-z0-9+\-.]*:/i.test(e))return e;if(e.startsWith("//"))return(window.location?.protocol||"https:")+e;/^[\w.-]+\.[a-z]{2,}([/:?#]|$)/i.test(e)&&(e="https://"+e);try{const a=new URL(e,window.location.origin),q=a.pathname.split("/").pop()||"";return!/\.[a-z0-9]+$/i.test(q)&&!a.search&&!a.hash&&!a.pathname.endsWith("/")&&(a.pathname+="/"),a.toString()}catch{return e}}const g=n(()=>l.value?.slug||c.value||u?.slug||"activity"),D=n(()=>{const t=r.query.url;if(t)return t;const e="/TaiyakiEduGames/".replace(/\/+$/,""),a=g.value||"activity";return`${e}/godot_games/${a}/index.html`}),y=n(()=>x(D.value));function M(t){try{return new URL(t).origin}catch{return null}}const T=new Set([typeof window<"u"?window.location.origin:""]),m=n(()=>{const t=M(y.value);return t&&T.has(t)?t:null});function L(){if(!m.value)return;const t={version:"1.0.0",activity_id:l.value?.id||g.value,slug:l.value?.slug||g.value};A.value?.contentWindow?.postMessage({type:"parent:init",payload:t},m.value)}function E(t){if(!m.value||t.origin!==m.value)return;const{type:e,payload:a}=t.data||{};e==="request:fullscreen"&&H(),e==="xp:award"&&console.info("[ActivityRunner] xp:award",a),e==="track:event"&&console.info("[ActivityRunner] track:event",a)}function H(){const t=A.value||h.value||document.documentElement,e=t.requestFullscreen||t.webkitRequestFullscreen||t.msRequestFullscreen;e&&e.call(t)}return S(()=>window.addEventListener("message",E)),P(()=>window.removeEventListener("message",E)),(t,e)=>(o(),i("div",j,[s("button",{class:"home-button",type:"button",onClick:I,"aria-label":"Back"},[s("img",{src:F(Y),alt:""},null,8,K)]),s("header",_,[s("h1",$,f(U.value),1)]),s("main",ee,[s("div",{class:"frame-wrap",ref_key:"frameWrap",ref:h},[y.value?(o(),i("iframe",{key:0,ref_key:"frameEl",ref:A,src:y.value,title:"",allow:"fullscreen; autoplay; gamepad",allowfullscreen:"",sandbox:"allow-scripts allow-same-origin allow-pointer-lock allow-forms allow-popups",onLoad:L},null,40,te)):(o(),i("div",ae,[s("p",se,f(p.value?"Loading activityâ€¦":v.value||"No external URL configured for this activity."),1)]))],512),s("div",{class:"under-actions"},[s("button",{class:"btn primary",onClick:H}," Go Fullscreen ")]),R.value.length?(o(),i("section",le,[s("div",ne,[(o(!0),i(Z,null,Q(R.value,a=>(o(),i("span",{key:a,class:"chip"},"# "+f(a),1))),128))])])):G("",!0),e[0]||(e[0]=J('<section class="achievements" data-v-4841d481><h2 class="section-title" data-v-4841d481>Achievements</h2><div class="badges" data-v-4841d481><div class="badge locked" data-v-4841d481><div class="icon" data-v-4841d481>ğŸ†</div><div class="label" data-v-4841d481>Locked</div></div><div class="badge locked" data-v-4841d481><div class="icon" data-v-4841d481>â­</div><div class="label" data-v-4841d481>Locked</div></div><div class="badge locked" data-v-4841d481><div class="icon" data-v-4841d481>ğŸ¯</div><div class="label" data-v-4841d481>Locked</div></div><div class="badge locked" data-v-4841d481><div class="icon" data-v-4841d481>â±ï¸</div><div class="label" data-v-4841d481>Locked</div></div></div><small class="muted note" data-v-4841d481>Achievement tracking coming soon.</small></section>',1))])]))}}),de=X(ie,[["__scopeId","data-v-4841d481"]]);export{de as default};
